"use strict";angular.module("homeModule",["ui.router","ngMockE2E"]),angular.module("homeModule").factory("enums",function(){return{table:"app/home/views/table.html",chart:"app/home/views/chart.html",unsupported:"app/home/views/unsupported.html",notFound:"app/home/views/notFound.html"}}),angular.module("homeModule").factory("dataSvc",["backEnd","$q",function(e,t){function r(){var r=t.defer();return a.length?r.resolve(a):e.getGroups().then(function(e){var t=_.map(e,function(e){return e.group});a.length||(a=t),r.resolve(a)},function(e){r.reject(e)}),r.promise}function o(e){return _.find(a,{id:e})}var a=[];return{getGroups:r,getItem:function(e){var n,u=t.defer();return a.length?(n=o(e),u.resolve(n)):r().then(function(){n=o(e),u.resolve(n)},function(e){u.reject(e)}),u.promise}}}]),angular.module("homeModule").factory("colorGenerator",function(){function e(){for(var e="0123456789ABCDEF".split(""),t="#",r=0;6>r;r++)t+=e[Math.floor(16*Math.random())];return t}return{getColor:e}}),angular.module("homeModule").factory("backEnd",["baseUrl","$http","loader",function(e,t,r){return{getGroups:function(){return r.loader=!0,t.get(e+"/teams/group_results").then(function(e){return r.loader=!1,e.data})}}}]),angular.module("homeModule").directive("chartView",["colorGenerator","$window",function(e,t){return function(r,o){function a(){n=new d3pie("pie-chart",{size:{canvasWidth:o[0].clientWidth,canvasHeight:350,pieInnerRadius:"30%",pieOuterRadius:"90%"},data:{sortOrder:"value-desc",content:u},labels:{outer:{pieDistance:15},inner:{hideWhenLessThanPercentage:3},mainLabel:{color:"#fffeff",fontSize:15},percentage:{color:"#ffffff",decimalPlaces:0},value:{color:"#adadad",fontSize:11},lines:{enabled:!0},truncation:{enabled:!0}},effects:{pullOutSegmentOnClick:{effect:"linear",speed:400,size:8}},misc:{gradient:{enabled:!0,percentage:100}}})}var n,u=_.map(r.item.teams,function(t){return{label:t.team.country,color:e.getColor(),value:t.team.points}});angular.element(t).bind("resize",function(){n.updateProp("size.canvasWidth",o[0].clientWidth)}),a(),r.$on("$destroy",function(){n=null,angular.element(t).unbind("resize")})}}]),angular.module("homeModule").controller("ListCtrl",["$scope","$state","groups",function(e,t,r){var o=e;o.groups=r,o.activeItem=t.params.groupId,o.activeMode=t.params.mode,o.$on("$stateChangeSuccess",function(e,t,r){o.activeItem=r.groupId,o.activeMode=r.mode})}]),angular.module("homeModule").controller("ErrCtrl",["$scope","error","loader",function(e,t,r){r.loader=!1,e.error=t}]),angular.module("homeModule").controller("DetailsCtrl",["$scope","item","$state","enums",function(e,t,r,o){var a=e;a.item=t,a.mode=o[r.params.mode]?o[r.params.mode]:o.unsupported,a.currentView=r.params.mode,"notFound"===r.params.mode&&(a.mode=o.unsupported),a.item||(a.mode=o.notFound)}]),angular.module("homeModule").run(["$httpBackend","useGroupMock",function(e,t){function r(){var e,t=new XMLHttpRequest;return t.open("GET","../mocks/serverData.json",!1),t.send(null),e=angular.fromJson(t.response)}t===!0&&e.whenGET(/.*\/group_results$/).respond(function(){return[200,r(),{}]})}]),angular.module("homeModule").config(["$stateProvider",function(e){e.state("groupList",{url:"/groupList",templateUrl:"app/home/views/groupSelector.html",controller:"ListCtrl",resolve:{groups:["dataSvc",function(e){return e.getGroups()}]}}).state("groupList.item",{url:"/{groupId:int}/{mode:string}",templateUrl:"app/home/views/groupDetails.html",controller:"DetailsCtrl",resolve:{item:["dataSvc","$stateParams",function(e,t){return e.getItem(t.groupId)}]}}).state("error",{url:"/backEndError",templateUrl:"app/home/views/error.html",controller:"ErrCtrl",resolve:{error:function(){return this.self.error}}})}]),angular.module("configModule",[]).constant("baseUrl","http://worldcup.sfg.io").constant("useGroupMock",!1).constant("allowPassThrough",!0),angular.module("worldCup",["homeModule","configModule"]).config(["$urlRouterProvider",function(e){e.otherwise("/groupList")}]).factory("loader",function(){return{loader:!0}}).controller("globalCtrl",["$scope","loader",function(e,t){e.loader=t}]),angular.module("worldCup").run(["$httpBackend","allowPassThrough","$rootScope","$state",function(e,t,r,o){r.$on("$stateChangeError",function(e,t,r,a,n,u){return e.preventDefault(),o.get("error").error="URL is unavailable "+u.config.url,o.go("error")}),t&&(e.whenGET(/.*/).passThrough(),e.whenPUT(/.*/).passThrough(),e.whenPOST(/.*/).passThrough(),e.whenDELETE(/.*/).passThrough())}]),function(e){try{e=angular.module("worldCup")}catch(t){e=angular.module("worldCup",[])}e.run(["$templateCache",function(e){e.put("app/home/views/chart.html",'<div class="chart-view"><div id="pie-chart" chart-view=""></div></div>')}])}(),function(e){try{e=angular.module("worldCup")}catch(t){e=angular.module("worldCup",[])}e.run(["$templateCache",function(e){e.put("app/home/views/error.html",'<div class="error-view">Something went wrong<br>I guess some backend problems<br>But You can always run app without backend<br>Just run site locally with command <span>gulp serve --dev 1</span><br>it will use mockups<br>Error itself:<br>{{error | json}}</div>')}])}(),function(e){try{e=angular.module("worldCup")}catch(t){e=angular.module("worldCup",[])}e.run(["$templateCache",function(e){e.put("app/home/views/groupDetails.html",'<div class="results" ng-include="mode"></div>')}])}(),function(e){try{e=angular.module("worldCup")}catch(t){e=angular.module("worldCup",[])}e.run(["$templateCache",function(e){e.put("app/home/views/groupSelector.html",'<div class="col-sm-2"><h2>Browse groups</h2><ul class="list-group"><li class="list-group-item" ng-repeat="item in groups" ng-class="{active: item.id===activeItem}"><span class="list-group-item-heading">{{item.letter}}</span><span class="view-ype" ui-sref="groupList.item({ groupId : item.id, mode: \'table\'})" ng-class="{active: item.id===activeItem&&activeMode===\'table\'}">Table</span><span class="view-ype" ui-sref="groupList.item({ groupId : item.id, mode: \'chart\'})" ng-class="{active: item.id===activeItem&&activeMode===\'chart\'}">Chart</span></li></ul></div><div class="col-sm-10"><div ui-view=""></div></div>')}])}(),function(e){try{e=angular.module("worldCup")}catch(t){e=angular.module("worldCup",[])}e.run(["$templateCache",function(e){e.put("app/home/views/notFound.html",'<div class="unsupported">Sorry but group does not exist</div>')}])}(),function(e){try{e=angular.module("worldCup")}catch(t){e=angular.module("worldCup",[])}e.run(["$templateCache",function(e){e.put("app/home/views/table.html",'<div class="table-view"><table class="table table-hover"><thead><tr><th>Country</th><th>FIFA Code</th><th>Points</th></tr></thead><tbody><tr ng-repeat="teamData in item.teams"><td ng-bind="teamData.team.country"></td><td ng-bind="teamData.team.fifa_code"></td><td ng-bind="teamData.team.points"></td></tr></tbody></table></div>')}])}(),function(e){try{e=angular.module("worldCup")}catch(t){e=angular.module("worldCup",[])}e.run(["$templateCache",function(e){e.put("app/home/views/unsupported.html",'<div class="unsupported">Sorry but this view `{{currentView}}` currently is not supported</div>')}])}();